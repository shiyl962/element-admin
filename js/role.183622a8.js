(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["role"],{7030:function(e,i,t){},a199:function(e,i,t){"use strict";var s=t("7030"),o=t.n(s);o.a},df1a:function(e,i,t){"use strict";t.r(i);var s=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[t("el-table-column",{attrs:{prop:"roleId",label:"Id",align:"center",width:"220"}}),t("el-table-column",{attrs:{prop:"roleName",label:"角色名称",align:"center",width:"220"}}),t("el-table-column",{attrs:{prop:"description",label:"备注"}}),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.editOpen(i.row)}}},[e._v(" 编辑权限 ")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(i){e.groupDialog.visible=!0}}},[e._v(" 菜单分组 ")]),t("el-button",{attrs:{type:"danger",size:"small"}},[e._v(" 删除 ")])]}}])},[t("template",{slot:"header"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-document-add"},on:{click:e.addOpen}},[e._v("新 增")])],1)],2)],1),t("el-dialog",{attrs:{title:e.dialog.roleId?"编辑":"新增角色",visible:e.dialog.visible},on:{"update:visible":function(i){return e.$set(e.dialog,"visible",i)}}},[t("el-form",{ref:"form",attrs:{model:e.dialog.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"角色名称",prop:"roleName",rules:[{required:!0,message:"请输入角色名称",trigger:"blur"}]}},[t("el-input",{model:{value:e.dialog.form.roleName,callback:function(i){e.$set(e.dialog.form,"roleName",i)},expression:"dialog.form.roleName"}})],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{type:"textarea",rows:2},model:{value:e.dialog.form.description,callback:function(i){e.$set(e.dialog.form,"description",i)},expression:"dialog.form.description"}})],1),t("el-form-item",{attrs:{label:"页面权限"}},e._l(e.pages,(function(i){return t("div",{key:i.pageId},[t("el-checkbox",{staticStyle:{width:"100px"},model:{value:i.isAdd,callback:function(t){e.$set(i,"isAdd",t)},expression:"item.isAdd"}},[e._v(e._s(i.title)+" ")]),t("el-checkbox",{attrs:{disabled:!i.isAdd},model:{value:i.permission,callback:function(t){e.$set(i,"permission",t)},expression:"item.permission"}},[e._v("permission")]),t("el-checkbox",{attrs:{disabled:!i.isAdd},model:{value:i.hidden,callback:function(t){e.$set(i,"hidden",t)},expression:"item.hidden"}},[e._v(" hidden ")]),t("el-checkbox",{attrs:{disabled:!i.isAdd},model:{value:i.affix,callback:function(t){e.$set(i,"affix",t)},expression:"item.affix"}},[e._v(" affix ")])],1)})),0)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(i){e.dialog.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),t("el-dialog",{staticClass:"my-dialog",attrs:{title:"分组设置",visible:e.groupDialog.visible},on:{"update:visible":function(i){return e.$set(e.groupDialog,"visible",i)}}},[t("div",{staticStyle:{padding:"10px"}},[t("el-button",{attrs:{size:"mini",type:"primary",plain:"",icon:"el-icon-plus"}},[e._v("新增分组")])],1),t("div"),t("el-tree",{attrs:{data:e.groupDialog.treeData,"node-key":"id",draggable:"","allow-drop":e.allowDrop,"expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(i){i.node;var s=i.data;return t("div",{staticClass:"custom-tree-node"},[t("div",{staticClass:"custom-tree-node-item"},[s.children&&s.edit?[t("EditItem",{ref:"edit-icon-"+s.id,staticStyle:{"margin-right":"10px"},attrs:{options:{type:"icon",clearable:!0},"hidden-message":!0,size:"mini"},model:{value:s.icon,callback:function(i){e.$set(s,"icon",i)},expression:"data.icon"}}),t("EditItem",{ref:"edit-title-"+s.id,attrs:{options:{clearable:!0,rules:e.titleRules},"hidden-message":!0,size:"mini"},model:{value:s.title,callback:function(i){e.$set(s,"title",i)},expression:"data.title"}})]:[t("div",{staticStyle:{"margin-right":"10px"}},[t("i",{class:s.icon})]),t("div",[e._v(e._s(s.title))])]],2),s.children?t("div",[s.edit?[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.submitItem(s)}}},[e._v(" 保存 ")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.closeEditItem(s)}}},[e._v(" 取消 ")])]:t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return i.stopPropagation(),e.editTreeItem(s)}}},[e._v(" 编辑 ")]),t("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:"mini"}},[e._v(" 删除 ")])],2):e._e()])}}])}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(i){e.groupDialog.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("保 存")])],1)],1)],1)},o=[],l={name:"Role",components:{},data(){return{pages:[],tableData:[{roleId:"0",roleName:"admin",description:"当前账号相当于admin，这些全是admin下的子角色，admin 就是超级管理员，系统应该自己初始化，不需要创建，也不能被修改",role:[{pageId:"1",permission:!0,affix:!0},{pageId:"2",permission:!0},{pageId:"3",permission:!0},{pageId:"4",permission:!0},{pageId:"5",permission:!0}]},{roleId:"1",roleName:"开发人员",description:"开发人员也可以拥有全部权限",role:[{pageId:"1",permission:!0,affix:!0},{pageId:"2",permission:!0},{pageId:"3",permission:!0},{pageId:"4",permission:!0},{pageId:"5",permission:!0}]},{roleId:"2",roleName:"管理员",description:"角色管理和用户管理的权限应该保持一致",role:[{pageId:"1",permission:!0,affix:!0},{pageId:"3",permission:!0},{pageId:"4",permission:!0},{pageId:"5",permission:!0}]},{roleId:"3",roleName:"管理员2",description:"每个角色只能操作自己创建的子角色，并且只能分配自己拥有权限的页面",role:[]}],dialog:{visible:!1,roleId:"",form:{roleName:"",description:""}},groupDialog:{visible:!1,roleId:"",treeData:[{id:"1",path:"/index",title:"首页",icon:"el-icon-s-home",affix:!0},{id:"2",title:"权限管理",icon:"el-icon-s-tools",children:[{id:"2-1",path:"/permis/menu",title:"菜单管理"},{id:"2-2",path:"/permis/role",title:"角色管理"},{id:"2-3",path:"/permis/account",title:"用户管理"}]},{id:"3",path:"/icon",title:"图标",icon:"el-icon-s-opportunity"},{id:"4",path:"/about",title:"数据看板",icon:"el-icon-s-marketing"},{id:"5",title:"嵌套路由",icon:"el-icon-finished",children:[{id:"5-1",hidden:!0,path:"/menu1",title:"回到顶部",icon:"el-icon-caret-top"},{id:"5-2",path:"/menu2",title:"换肤预览",icon:"el-icon-s-marketing"},{id:"5-3",path:"/menu3",title:"无权限",icon:"el-icon-s-marketing",permission:!1}]}]},titleRules:[{required:!0,message:"请输入菜单名称"},{min:2,max:5,message:"长度在 2 到 5 个字符"}]}},created(){this.getPagesList()},methods:{getPagesList(){const e=[{pageId:"1",title:"首页"},{pageId:"2",title:"菜单管理"},{pageId:"3",title:"角色管理"},{pageId:"4",title:"用户管理"},{pageId:"5",title:"图标"}];setTimeout(()=>{this.pages=e,this.pages.forEach(e=>{this.$set(e,"permission",!1),this.$set(e,"hidden",!1),this.$set(e,"affix",!1)})},200)},addOpen(){this.dialog.roleId="",this.dialog.form={roleName:"",description:""},this.pages.forEach(e=>{this.$set(e,"isAdd",!1),this.$set(e,"permission",!1),this.$set(e,"hidden",!1),this.$set(e,"affix",!1)}),this.$refs.form&&this.$refs.form.resetFields(),this.dialog.visible=!0},editOpen(e){this.dialog.roleId=e.roleId,this.dialog.form={roleName:e.roleName,description:e.description},this.pages.forEach(i=>{const t=e.role.find(e=>e.pageId===i.pageId);t?(this.$set(i,"isAdd",!0),this.$set(i,"permission",t.permission||!1),this.$set(i,"hidden",t.hidden||!1),this.$set(i,"affix",t.affix||!1)):(this.$set(i,"isAdd",!1),this.$set(i,"permission",!1),this.$set(i,"hidden",!1),this.$set(i,"affix",!1))}),this.$refs.form&&this.$refs.form.resetFields(),this.dialog.visible=!0},submitForm(){this.$refs.form.validate(e=>{if(e){const e=Object.assign({roleId:this.dialog.roleId},this.dialog.form);e.role=this.pages.filter(e=>e.isAdd),console.log(e)}})},allowDrop(e,i,t){return!i.data.path||"inner"!==t},editTreeItem(e){this.$set(e,"edit",!0)},closeEditItem(e){this.$set(e,"edit",!1),this.$set(e,"icon",this.$refs["edit-icon-"+e.id].initValue),this.$set(e,"title",this.$refs["edit-title-"+e.id].initValue)},submitItem(e){this.$refs["edit-title-"+e.id].validateRow().then(()=>{console.log("校验通过")}).catch(e=>{this.$message.error(e[0].message)})}}},a=l,r=(t("a199"),t("2877")),n=Object(r["a"])(a,s,o,!1,null,"55a3fbfe",null);i["default"]=n.exports}}]);
//# sourceMappingURL=role.183622a8.js.map